{% extends "base.html" %}
{% block title %}–ì–ª–∞–≤–Ω–∞—è ‚Äî –¢–ê–°–° –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç{% endblock %}
{% block content %}
  <h1>–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –≤—ã–ø—É—Å–∫–∞—é—â–µ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞</h1>

  <div class="welcome-block">
    <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <strong>–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –≤—ã–ø—É—Å–∫–∞—é—â–µ–≥–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç—Å—Ç–≤–∞ –¢–ê–°–°</strong>.</p>
    <p>–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–≤ –∏ –ø–æ–º–æ—â–∏ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤.</p>

    {% if not current_user.is_authenticated %}
      <p><a href="{{ url_for('auth.login') }}">–í–æ–π–¥–∏—Ç–µ</a> –∏–ª–∏ <a href="{{ url_for('auth.register') }}">–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å</a>, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º —Å–∏—Å—Ç–µ–º—ã.</p>
    {% endif %}
  </div>

  {% if current_user.is_authenticated %}
    <hr style="border: none; border-top: 1px solid var(--tass-border); margin: 2rem 0;">

    <!-- –§–æ—Ä–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–æ–≤–æ—Å—Ç–∏ -->
    <div class="card">
      <h2 class="card__title">–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤–æ—Å—Ç–∏</h2>
      <p class="card__sub">–í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —ç—Ç–∞–ø—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏</p>

      <form id="newsProcessingForm" class="form" data-action-url="{{ url_for('main.process_news') }}">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

        <div>
          <label class="label" for="newsText">–¢–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏</label>
          <div
            id="newsText"
            class="textarea"
            contenteditable="true"
            data-placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Å—é–¥–∞ —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏..."
            style="min-height: 200px;"
          ></div>
          <p class="help">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç (–º–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å –∏–∑ Word, Google Docs –∏ —Ç.–¥.)</p>
        </div>

        <div>
          <label class="label">–≠—Ç–∞–ø—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏</label>
          {% if stages %}
            <div class="stages-selector">
              {% for stage in stages %}
                <label
                  class="stage-checkbox"
                  data-stage-name="{{ stage.name }}"
                  {% if stage.description %}title="{{ stage.description }}"{% endif %}
                >
                  <input
                    type="checkbox"
                    name="stage_ids"
                    value="{{ stage.id }}"
                    data-stage-name="{{ stage.name }}"
                    {% if not stage.has_model %}disabled{% endif %}
                  >
                  <span class="stage-checkbox__label">
                    {{ stage.display_name }}
                    {% if not stage.has_model %}
                      <span class="badge badge--warning">–ù–µ—Ç –º–æ–¥–µ–ª–∏</span>
                    {% endif %}
                  </span>
                </label>
              {% endfor %}
            </div>
          {% else %}
            <p class="help" style="color: var(--warn);">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.</p>
          {% endif %}
        </div>

        <div style="display: flex; gap: 12px; align-items: center;">
          <button type="submit" class="btn btn--primary" id="submitBtn">
            –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å
          </button>
          <span id="processingStatus" class="help" style="display: none;">
            –û–±—Ä–∞–±–æ—Ç–∫–∞...
          </span>
        </div>
      </form>
    </div>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ -->
    <div id="resultsContainer" style="display: none; margin-top: 2rem;">
      <div class="card">
        <h2 class="card__title">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏</h2>
        <div id="resultsContent"></div>
      </div>
    </div>

    <hr style="border: none; border-top: 1px solid var(--tass-border); margin: 2rem 0;">

    <h2>–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</h2>
    <div class="cards-grid">
      <div class="card">
        <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
        <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Å–∏—Å—Ç–µ–º—ã –∏ –≤–∞—à–∏–º –ø—Ä–æ—Ñ–∏–ª–µ–º.</p>
        <a href="{{ url_for('settings.index') }}" class="btn btn--muted">–ü–µ—Ä–µ–π—Ç–∏ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º ‚Üí</a>
      </div>

      <div class="card">
        <h3>üìú –ò—Å—Ç–æ—Ä–∏—è</h3>
        <p>–ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤.</p>
        <a href="{{ url_for('history.index') }}" class="btn btn--muted">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é ‚Üí</a>
      </div>

      {% if current_user.is_admin %}
        <div class="card">
          <h3>ü§ñ –ü–æ–º–æ—â–Ω–∏–∫–∏</h3>
          <p>AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.</p>
          <a href="{{ url_for('assistants.index') }}" class="btn btn--muted">–û—Ç–∫—Ä—ã—Ç—å –ø–æ–º–æ—â–Ω–∏–∫–∏ ‚Üí</a>
        </div>
      {% endif %}
    </div>
  {% endif %}
{% endblock %}